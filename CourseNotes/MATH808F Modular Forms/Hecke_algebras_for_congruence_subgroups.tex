\documentclass[main]{subfiles}

\begin{document}

In this section we use the following notations: $G=\GL_2(\mathbb R)^+$, for $N\in\mathbb Z_{\geq2}$, define
\[\Gamma(N)=\left\{g\in\SL_2(\mathbb Z)\middle|g\equiv\begin{bmatrix}
1&0\\
0&1
\end{bmatrix}\mod N\right\}\text{ principal congruence subgroup}\]
\[\Gamma_0(N)=\left\{\begin{bmatrix}
a&b\\
c&d
\end{bmatrix}\in\SL_2(\mathbb Z)\middle|c\equiv0\mod N\right\}\]
\[\Gamma_1(N)=\left\{g\in\SL_2(\mathbb Z)\middle|g\equiv\begin{bmatrix}
1&*\\
0&1
\end{bmatrix}\mod N\right\}\]
When $N=1$, define $\Gamma(1)=\Gamma_0(1)=\Gamma_1(1)=\SL_2(\mathbb Z)$

\begin{definition}
$\Gamma\leq\SL_2(\mathbb Z)$ is a \textit{congruence subgroup} if $\exists N\in\mathbb Z_{\geq1}$ such that $\Gamma\supseteq\Gamma(N)$
\end{definition}

Since $\SL_2(\mathbb Z)$ is generated by unipotent groups, the reduction map $\SL_2(\mathbb Z)\to\SL_2(\mathbb Z/N\mathbb Z)$ is surjective $\forall N\in\mathbb Z_{\geq1}$. In particular, $\Gamma_0(N)/\Gamma_1(N)\cong(\mathbb Z/N\mathbb Z)^\times$, $\begin{bmatrix}
a&b\\
c&d
\end{bmatrix}\mapsto d\mod N$

\begin{lemma}
\[|\SL_2(\mathbb Z)/\Gamma(N)|=|\SL_2(\mathbb Z/N\mathbb Z)|=N^3\prod_{p|N}\left(1-\frac{1}{p^2}\right)\]
\[|\SL_2(\mathbb Z)/\Gamma_0(N)|=N\prod_{p|N}\left(1+\frac{1}{p}\right)\]
\[|\Gamma_0(N)/\Gamma_1(N)|=|(\mathbb Z/n\mathbb Z)^\times|\]
\end{lemma}

Let $\mathscr C=\{\text{congruence modular groups}\}$, $\{\Gamma(N)\}_{N\geq1}$ forms a cofinal subset. $\forall\Gamma,\Gamma'\in\mathscr C$, $\forall g\in G$ such that $^g\Gamma=g\Gamma g^{-1}\supseteq\Gamma'$ induces
\begin{center}
\begin{tikzcd}
l_g: & M_k(\Gamma) \arrow[r]                 & M_k(\Gamma')                 & f \arrow[r,mapsto] & f\cdot_kg^{-1} \\
    & S_k(\Gamma) \arrow[r] \arrow[u, hook] & S_k(\Gamma') \arrow[u, hook] &             &           
\end{tikzcd}
\end{center}
Denote $\mathcal A(\Gamma)=\mathcal A(\Gamma\backslash G/Z_G^+)$, $\mathcal A_0(\Gamma)=\mathcal A_0(\Gamma\backslash G/Z_G^+)$. Then
\begin{center}
\begin{tikzcd}
l_g: & \mathcal A(\Gamma) \arrow[r]                   & \mathcal A(\Gamma')                   & \phi \arrow[r,mapsto] & (l_g\phi)(x)=\phi(g^{-1}x) \\
     & \mathcal A_0(\Gamma) \arrow[r] \arrow[u, hook] & \mathcal A_0(\Gamma') \arrow[u, hook] &                &                           
\end{tikzcd}
\end{center}
Let $M_k=\varprojlim_{\Gamma\in\mathscr C}M_k(\Gamma)$, similarly $S_k,\mathcal A,\mathcal A_0$. These are representations of $\GL_2(\mathbb Q)^+$ under left regular action. The natural embedding
\begin{center}
\begin{tikzcd}
M_k \arrow[r, hook]                 & \mathcal A                   \\
S_k \arrow[u, hook] \arrow[r, hook] & \mathcal A_0 \arrow[u, hook]
\end{tikzcd}
\end{center}
is $\GL_2(\mathbb Q)^+$ equivariant, and induces isomorphism
\begin{center}
\begin{tikzcd}
M_k \arrow[r, "\cong"]                 & {\Hom_{(\mathfrak g,K)}(D^+(k),\mathcal A)}                   \\
S_k \arrow[u, hook] \arrow[r, "\cong"] & {\Hom_{(\mathfrak g,K)}(D^+(k),\mathcal A_0)} \arrow[u, hook]
\end{tikzcd}
\end{center}

\begin{note}
\[\begin{bmatrix}
1&0\\
0&N
\end{bmatrix}^{-1}\Gamma(N)\begin{bmatrix}
1&0\\
0&N
\end{bmatrix}\supseteq\Gamma_1(N^2),\forall N\in\mathbb Z_{\geq1}\]
\end{note}

So $\{\Gamma_1(N)\}_{N\geq1}$ is a cofinal subset of $\mathscr C$ and $M_k=\bigcup_{N\geq1}M_k(\Gamma_1(N))$, $S_k=\bigcup_{N\geq1}S_k(\Gamma_1(N))$. $\forall$ character $\chi:(\mathbb Z/n\mathbb Z)^\times\to\mathbb C^\times$, viewed as a character $\Gamma_0(N)\to\mathbb C^\times$, $\begin{bmatrix}
a&b\\
c&d
\end{bmatrix}\mapsto\chi(d\mod N)$. Let
\[M_k(\Gamma_0(N),\chi)=\{f\in M_k(\Gamma_1(N))|f|_k\gamma=\chi(\gamma)f,\forall\gamma\in\Gamma_0(N)\}\]
Then
\[M_k(\Gamma_1(N))=\bigoplus_{\chi}M_k(\Gamma_0(N),\chi)\]
\[S_k(\Gamma_1(N))=\bigoplus_{\chi}S_k(\Gamma_0(N),\chi)\]
$\forall\Gamma\in\mathscr C$, $\mathscr H(\GL_2(\mathbb Q)^+//\Gamma)$ acts on $M_k^\Gamma=M_k(\Gamma)$ and $S_k(\Gamma)$, this algebra is non-commutative in general, we will study a large enough commutative subalgebra, when $\Gamma=\Gamma_1(N)$ (Recall: $\mathscr H(\GL_2(\mathbb Q)^+//\SL_2(\mathbb Z))=\otimes_p\mathbb C[T_p,R_p^{\pm1}]$ is commutative). Define the following submonoids of $\GL_2(\mathbb Q)^+$
\[\Omega_0(N)=\left\{\begin{bmatrix}
a&b\\
c&d
\end{bmatrix}\in M_2(\mathbb Z)\cap\GL_2(\mathbb Q)^+\middle|(d,N)=1,N|c\right\}\supseteq\Gamma_0(N)\]
\[\Omega_1(N)=\left\{\begin{bmatrix}
a&b\\
c&d
\end{bmatrix}\in \Omega_0(N)\middle|d\equiv1\mod N\right\}\supseteq\Gamma_1(N)\]
$\mathscr H_0(N)=\mathscr H(\Omega_0(N)//\Gamma_0(N))$, $\mathscr H_1(N)=\mathscr H(\Omega_1(N)//\Gamma_1(N))$
\begin{center}
\begin{tikzcd}
\mathcal H_1(N) \arrow[rd, "\cong"'] \arrow[r, hook] & \mathscr H(\Omega_0(N)//\Gamma_1(N)) \arrow[d, "\mathrm{Avg}", shift left] & \mathscr H(\Omega_1(N)//\Gamma_0(N)) \arrow[l, hook] \arrow[r, "\cong"'] & {\mathbb C[\Omega_1(N)/\Gamma_0(N)]} \\
                                                     & \mathcal H_0(N) \arrow[u, hook, shift left]                                &                                                                          &                                     
\end{tikzcd}
\end{center}
$\operatorname{Avg}(\phi)=e_0(N)*\phi*e_0(N)$, $e_0(N)=\dfrac{1}{|(\mathbb Z/n\mathbb Z)^\times|}1_{\Gamma_0(N)/\Gamma_1(N)}$. The involution $\begin{bmatrix}
a&b\\
Nc&d
\end{bmatrix}\mapsto\begin{bmatrix}
a&c\\
Nb&d
\end{bmatrix}$ on $\Omega_0(N)$ and $\Omega_1(N)$ implies that $\mathscr H_0(N)$, $\mathscr H_1(N)$ are commutative

\begin{lemma}
Let $\Lambda_+(N)=\{(l,m)\in\mathbb Z_{\geq1}^2|m|l,(m,N)=1\}$, then
\[\Omega_0(N)=\bigsqcup_{(l,m)\in\Lambda_+(N)}\Gamma_0(N)\begin{bmatrix}
l&0\\
0&m
\end{bmatrix}\Gamma_0(N)\]
\end{lemma}

\begin{proof}

\end{proof}

\begin{lemma}
$\forall\lambda,\mu\in\Lambda_+(N)$, $1_\lambda*1_\mu=\sum_{\nu\in\Lambda_+(N)}c^\nu_{\lambda\mu}1_\nu$ in $\mathscr H_0(N)$, where
\[c^\nu_{\lambda\mu}=\#\{A\subseteq Q_\nu\text{ subgroup}|A\cong Q_\mu,Q_\nu/A\cong Q_\lambda\}\]
same structure constants as in $\mathfrak{sl}_2(\mathbb Z)$ case
\end{lemma}

\begin{proof}

\end{proof}

\end{document}